---
title: "Case study: Human Resources Analytics"
author: "Przemyslaw Biecek"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r,   warning = FALSE, message = FALSE}
library(live)
library(mlr)
library(breakDown)
library(randomForest)

head(HR_data)

HR_data$left <- as.numeric(HR_data$left)
trees <- randomForest(left~., data = HR_data, ntree=1000)

similar <- sample_locally(data = HR_data,
                          explained_instance = HR_data[1,],
                          explained_var = "left", 
                          size = 2000)
head(similar$data)

similar1 <- add_predictions(HR_Data, similar, black_box_model = trees)

trained <- fit_explanation(live_object = similar1, 
                           white_box = "regr.lm", 
                           selection = FALSE)

plot_explanation(trained, "waterfallplot", 
                 explained_instance = HR_data[1,])
plot_explanation(trained, "forestplot", 
                 explained_instance = HR_data[1,])
```
