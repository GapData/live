<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case study: wine quality • live</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">live</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/HR.html">Case study: Human Resources Analytics</a>
    </li>
    <li>
      <a href="../articles/TCGA.html">Case study: The Cancer Genome Atlas</a>
    </li>
    <li>
      <a href="../articles/wine_quality.html">Case study: wine quality</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MI2DataLab/live">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Case study: wine quality</h1>
                        <h4 class="author">Mateusz Staniak</h4>
            
          </div>

    
    
<div class="contents">
<pre><code>## Warning: replacing previous import 'BBmisc::isFALSE' by
## 'backports::isFALSE' when loading 'mlr'</code></pre>
<div id="about-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#about-the-data" class="anchor"></a>About the data</h3>
<p>Wine quality is a well-known dataset which was an object of study in Paulo Cortez, University of Minho, Guimarães, Portugal, <a href="http://www3.dsi.uminho.pt/pcortez" class="uri">http://www3.dsi.uminho.pt/pcortez</a> A. Cerdeira, F. Almeida, T. Matos and J. Reis, Viticulture Commission of the Vinho Verde Region(CVRVV), Porto, Portugal 2009. Lichman, M. (2013).</p>
<p>The dataset contains variuos properties of a set of wines. For each wine there is 11 features based on physicochemical tests like density or pH and also and outcome variable: a score that describes the wine’s quality. The score is based on evaluations made by wine experts.</p>
<p>According to the results from the original article, Support Vector Machine model is better than other models, including linear regression, for prediction purposes. In this section we will show how <code>live</code> package can be used to fit linear regression model locally and generate a visual explanation for the black box model.</p>
</div>
<div id="performance-comparison" class="section level3">
<h3 class="hasAnchor">
<a href="#performance-comparison" class="anchor"></a>Performance comparison</h3>
<p>First, we can perform a quick bechmark experiment to see that SVM performs better than linear regression and, say, neural network.</p>
<table class="table">
<thead><tr class="header">
<th>Learner</th>
<th>Mean MSE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>SVM</td>
<td>0.39</td>
</tr>
<tr class="even">
<td>Linear regression</td>
<td>0.43</td>
</tr>
<tr class="odd">
<td>Neural network</td>
<td>0.55</td>
</tr>
</tbody>
</table>
</div>
<div id="explaining-single-prediction" class="section level3">
<h3 class="hasAnchor">
<a href="#explaining-single-prediction" class="anchor"></a>Explaining single prediction</h3>
<p>Suppose we want to understand prediction generated by SVM for the fifth observation in the dataset. To do this, we need to generate observations for local exploration.</p>
<div id="simulating-a-dataset" class="section level5">
<h5 class="hasAnchor">
<a href="#simulating-a-dataset" class="anchor"></a>Simulating a dataset</h5>
<p>We use <code>simulateSimilar</code> function from <code>live</code> package. <code>standardise</code> is set to <code>TRUE</code>, so all variables will be normalized.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">similar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sample_locally.html">sample_locally</a></span>(<span class="dt">data =</span> winequality_red,
                          <span class="dt">explained_instance =</span> winequality_red[<span class="dv">5</span>, ], 
                          <span class="dt">explained_var =</span> <span class="st">"quality"</span>, 
                          <span class="dt">size =</span> <span class="dv">100</span>,
                          <span class="dt">standardise =</span> <span class="ot">TRUE</span>)
similar1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/add_predictions.html">add_predictions</a></span>(winequality_red, similar, <span class="st">"regr.randomForest"</span>)
similar2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/add_predictions.html">add_predictions</a></span>(winequality_red, similar, <span class="st">"regr.svm"</span>)</code></pre></div>
</div>
<div id="training-white-box-model" class="section level4">
<h4 class="hasAnchor">
<a href="#training-white-box-model" class="anchor"></a>Training white box model</h4>
<p>Then we fit linear regression model to predictions generated by SVM for this simulated dataset using  function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trained &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fit_explanation.html">fit_explanation</a></span>(<span class="dt">live_object =</span> similar1,
                           <span class="dt">white_box =</span> <span class="st">"regr.lm"</span>,
                           <span class="dt">selection =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>This function returns a native  object. Model object (for example lm object) can be extracted using  function. By setting  we choose to perform variable selection using AIC as implemented in  package which is available on CRAN.</p>
</div>
<div id="model-visualization" class="section level4">
<h4 class="hasAnchor">
<a href="#model-visualization" class="anchor"></a>Model visualization</h4>
<p>Now we can visualize fitted model by calling  function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_explanation.html">plot_explanation</a></span>(trained,
                 <span class="dt">regr_plot_type =</span> <span class="st">"forestplot"</span>,
                 <span class="dt">explained_instance =</span> winequality_red[<span class="dv">5</span>, ])</code></pre></div>
<p><img src="wine_quality_files/figure-html/plot-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_explanation.html">plot_explanation</a></span>(trained,
                 <span class="dt">regr_plot_type =</span> <span class="st">"waterfall"</span>,
                 <span class="dt">explained_instance =</span> winequality_red[<span class="dv">5</span>, ])</code></pre></div>
<p><img src="wine_quality_files/figure-html/plot-2.png" width="672"></p>
<p>Only variables chosen in the selection step are displayed. They are sorted according to the absolute value of t-test statistic. In the <code>Observed</code> column predictor values for case given in observation} argument are displayed. <code>Estimate</code> column gives fitted parameter values, while <code>Lower</code> and <code>Upper</code> give lower and upper bounds of 95% confidence interval, respectively. The plot show <code>Estimate</code> value on x axis. From the signs of the parameters and their magnitude wee can see how variables influence predictions.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mateusz Staniak, Przemysław Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
